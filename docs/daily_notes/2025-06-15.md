# Daily Notes ‚Äì 2025-06-15

| # | Task | Purpose / Details | Status |
|---|------|-------------------|--------|
| 1 | Add spaCy entity detection to AI-Engine validation | Merge spaCy PERSON/GPE/LOC entities into expected-token list so multi-word names are caught before publishing. | ‚úÖ Done |
| 2 | Ensure separate prompts in AI-Engine | Maintains two distinct prompts: (a) title+summary, (b) contextual_title_explanations. Confirmed and adjusted code paths. | ‚úÖ Done |
| 3 | Patch split-name checker | `check_name_tokens.py` now understands list- and dict-style explanations. | ‚úÖ Done |
| 4 | Create `quality_repair.py` second-pass fixer | Scans `rolling_articles.json` for missing tokens and fixes only those. | ‚úÖ Done |
| 5 | Add rich logging & cost tracking | Repair script writes full JSON report (tokens_missing / added, cost) to `logs/`. | ‚úÖ Done |
| 6 | Daily-note auto-update | Repair script appends one-line summary to today's note. | ‚úÖ Done |
| 7 | Dev-batch tests (2√ó10 articles) | Verified new validation; name-split failure-rate fell ‚âà40 % ‚ûú ‚âà30 %. | ‚úÖ Done |
| 8 | Tune prompt & retries | Push coverage above 90 % (long noun chains, second retry). | ‚è≥ Pending |
| 9 | Wire `quality_repair.py` into GitHub Actions | Run fixer automatically before deploy. | ‚è≥ Pending |
| 10 | Run large batch + archive metrics | Full production test after tuning, store quality & cost stats. | ‚è≥ Pending |
| 11 | Consider beginner/intermediate/advanced layers | Decide later whether to expand explanation schema. | ‚è∏ Deferred |

---

(Narrative log retained below for reference)

## Full log of actions on 2025-06-15

### Work completed
- Iteratively patched `
### Quality Repair 20250615_164327
Scanned 20 articles, fixed 0 missing tokens in 0 articles. Cost: $0.0018. Report: logs/quality_repair_report_20250615_164327.json

# Daily Engineering Log ‚Äì 2025-06-15

## What we accomplished today

* Netlify now serves the latest 20-article batch (front-end switched to `rolling_articles.json`).
* Added quick-guard & prod-smoke CI layers ‚Äì faster feedback & live deploy check.
* Re-organised repo structure: moved helper scripts to `dev_tools/`, split QA into `qa/local` and `qa/prod`, updated workflow paths.
* Implemented **Checkpoint-Resume (CR) system**: atomic `temp/batch_WIP.json`, resume logic in `AI-Engine`, artifact upload/restore in workflow.
* Fixed CI race condition: workflow now `git pull --rebase` and pushes with `--force-with-lease` ‚áí stops fast-forward failures when two runs overlap.

## Pain points / issues encountered

* Front-end was still loading `test_articles.json`, causing stale content.
* Need better quality "simplified" headings generated by AI.

## Task tracker

| Task | Purpose | Status |
|------|---------|--------|
| Improve simplified heading prompt + unit test | Better, shorter titles; prevent regressions | ‚ùå Pending |
| Add `--sample-size` flag to `generate_sample_batch.py` | Faster local experiments | ‚úÖ Done |
| Checkpoint-Resume system + artifact | Resume failed AI batch | ‚úÖ Done |
| Quick-guard CI job | Early syntax check | ‚úÖ Done |
| Prod-smoke CI job | Live site smoke test | ‚úÖ Done |
| Git push race fix (`pull --rebase` + `--force-with-lease`) | Prevent concurrent push failures | ‚úÖ Done |
| Repo re-organisation (`dev_tools/`, `qa/local`, `qa/prod`) | Cleaner structure & test split | ‚úÖ Done |
| Fix failing QA Smoke Test workflow | Ensure local Playwright tests pass after recent UI changes | üöß In Progress |

### Carry-over high-priority

Only remaining task today: finish the simplified-heading work (see above).

## File change log (why)

| File | Type | Reason |
|------|------|--------|
| `Project-Better-French-Website/script.js` | modified | Load live `rolling_articles.json` on production hosts. |
| `.github/workflows/auto-update.yml` | modified | Restore/upload checkpoint artifact; **added rebase + force-with-lease push to solve concurrency failure**. |
| `qa/tests/test_prod_deploy.py` | new | Freshness + smoke test against Netlify. |
| `scripts/checkpoint_utils.py` | new | Helpers for CR system (load/save/clear). |
| `scripts/AI-Engine.py` | modified | Save to checkpoint after each article, skip on resume. |
| `dev_tools/` | moved | Contains helpers like `generate_sample_batch.py` (now supports `--sample-size`). |
| `qa/local/` & `qa/prod/` | moved | Split tests by environment; workflows updated accordingly. |

---
*Log authored automatically by AI pair-programmer on 15 Jun 2025.* 