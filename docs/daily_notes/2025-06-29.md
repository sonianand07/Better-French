# Daily Note: 2025-06-29

## Session Summary
Fixed critical issue where V3 website wasn't updating despite successful article processing.

## Accomplishments ‚úÖ
1. **Identified V3 Deployment Issue**
   - V4 workflow was processing V3 articles but only deploying V4 site
   - Root site (V3) was never getting deployed
   
2. **Fixed V4 Workflow**
   - Added V3 deployment step to deploy-pages-v4.yml
   - Now deploys both V3 (root) and V4 (/v4-site/) when run
   - Used `keep_files: true` to preserve v4-site subdirectory

3. **Fixed V4 Article Persistence Issue**
   - V4 was only showing 10 articles because it discarded history each run
   - Changed V4 to accumulate enhanced articles over time (like V3)
   - Now V4 will build up growing collection: 10 ‚Üí 20 ‚Üí 30 ‚Üí 200+ articles

## Pain Points üò§
1. **Confusing Workflow Dependencies**
   - V4 workflow runs V3's processing but wasn't deploying V3's site
   - This created a situation where articles were processed but not visible

## Next Actions üöÄ
1. Run the updated V4 workflow to deploy both sites
2. Consider renaming workflows for clarity
3. Add monitoring to ensure both sites update

## File Change Log üìù

| File | Type | Reason |
|------|------|--------|
| `.github/workflows/deploy-pages-v4.yml` | Modified | Added V3 deployment + fixed V4 article persistence |
| `config/config.ini` | Removed | Removed from git tracking to prevent API key exposure |
| `config/config.ini.template` | Created | Safe template file for development setup |
| `config/README.md` | Created | Comprehensive security documentation and guidelines |
| `scripts/check_api_exposure.py` | Created | Pre-commit hook to detect exposed API keys |
| `.githooks/pre-commit` | Modified | Enhanced with API key detection capabilities |

## Technical Details üîß
The issue occurred because:
- V3 workflow is disabled (schedule commented out)
- V4 workflow processes V3 articles but only deployed to /v4-site/
- Solution: V4 workflow now deploys to both locations

## SECURITY INCIDENT üö®

**API Key Exposure Discovered:**
- OpenRouter API key was exposed in `config/config.ini` 
- File was tracked in git and publicly visible
- OpenRouter auto-detected and disabled the key
- Workflow failing with 401 authentication errors

**Immediate Actions Taken:**
- ‚úÖ Removed exposed key from config file
- ‚úÖ Removed config.ini from git tracking
- ‚úÖ Pushed security fix to GitHub

**Required Next Steps:**
1. Get new OpenRouter API key (old one is permanently disabled)
2. Store new key ONLY in GitHub Secrets (never commit to repo)
3. Test workflows with new key

## Task Tracker

| **Task** | **Status** | **Notes** |
|----------|------------|-----------|
| Identify V3 deployment issue | ‚úÖ Done | V4 workflow missing V3 deploy |
| Fix V4 workflow | ‚úÖ Done | Added V3 deployment step |
| Fix API key exposure | ‚úÖ Done | Removed from git tracking |
| Get new API key | ‚úÖ Done | Provided by user, stored in GitHub Secrets |
| Fix V4 article persistence | ‚úÖ Done | V4 now accumulates articles like V3 |
| Test deployment | ‚ùå Pending | Ready to run with both fixes |
| Monitor both sites | ‚ùå Pending | Verify updates appear 